<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Light Tech - Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="../../Styles/caddesh.css" />
  <!-- <link rel="stylesheet" href="./dash2/dash.css"> -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css" />
  <link rel="shortcut icon" href="../assets/icon/favicon2.ico" type="image/x-icon" />

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link
    href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet" />
</head>

<body>
  <!-- DIV PRINCIPAL QUE ALTERA TODO CONTEXTO DA PAGÍNA -->
  <div class="content-page">
    <!-- AQUI É TODO MEU HEADER-->
    <div class="header">
      <h1>
        Dashboard Light Tech
        <p>Seja bem vindo(a)</p>
      </h1>

      <!-- <div class="alerts-context"> -->
      <div class="conta">
        <span class="icon"><i class="bi bi-person-circle"></i></span>
        <span class="link-page">Conta</span>
      </div>
    </div>

    <!-- AQUI É TODO MEU MENU LATERAL -->
    <div class="content2">
      <div class="menu-lateral">
        <div class="logo">
          <a href="../../Index.html"><img src="../../Assets/Images/LogoFooter.svg" alt="Logo Lightech" /></a>
        </div>

        <div class="btn-expandir">
          <i class="bi bi-list" id="expandir-list"></i>
        </div>

        <ul>
          <li class="item-menu">
            <a href="Dashboard.html">
              <span class="icon"><i class="bi bi-house-heart"></i></span>
              <span class="link-page">Home</span>
            </a>
          </li>
          <li class="item-menu">
            <a href="Locais.html">
              <span class="icon"><i class="bi bi-clipboard-data"></i></span>
              <span class="link-page">Locais</span>
            </a>
          </li>
          <li class="item-menu ativo">
            <a href="Dash-CadastroFuncionario.html">
              <span class="icon"><i class="bi bi-calendar3"></i></span>
              <span class="link-page">Cadastrar</span>
            </a>
          </li>
        </ul>
      </div>

      <!-- Campos de cadastro -->
      <div class="cadastro">
        <h1 class="titulo-cadastro">Cadastro</h1>
        <div class="inputs">

          <div class="funcionario">
            <h4>Funcionario</h4>
            Nome: <input id="inputNome" required placeholder="Insira seu nome"><br>

            Sobrenome: <input id="inputSobrenome" required placeholder="Insira seu sobrenome"><br>

            Telefone Fixo: <input id="inputTelefoneFixo" placeholder="(00)0000-0000"><br>

            Telefone Celular: <input id="inputTelefoneCel" required placeholder="(00)90000-0000"><br>

            E-mail: <input id="inputEmail" required placeholder="Insira seu E-mail"><br>

            Senha: <input id="inputSenha" required placeholder="Insira sua senha"><br>

            <button onclick="cadastrarFuncionario()">Cadastrar Usuário</button>
          </div>

        </div>
      </div>

    </div>
  </div>
  </div>
  </div>
  <!-- <script src="../../Scripts/Dashboard.js"></script> -->
  <script src="../../Scripts/CadastroFuncionario.js"></script>
</body>

</html>
<script>
  
var classObj;
var nome;
var sobrenome; 
var telFixo;
var telCel; 
var email; 
var senha; 

function validacaoCadastro() {
    nome = inputNome.value
    sobrenome = inputSobrenome.value;
    telFixo = inputTelefoneFixo.value;
    telCel = inputTelefoneCel.value;
    email = inputEmail.value;
    senha = inputSenha.value;

    if (nome == "") {
        classObj = document.getElementById("inputNome")
        classObj.classList.remove("inputNome")
        classObj.classList.add("inputError")
        alert("Insira seu nome")

    } else {
        classObj = document.getElementById("inputNome")
        classObj.classList.remove("inputError")
        classObj.classList.add("inputNome")
    };

    if (sobrenome == "") {
        classObj = document.getElementById("inputSobrenome")
        classObj.classList.remove("inputSobrenome")
        classObj.classList.add("inputError")
        alert("Insira seu sobrenome")
        
    } else {
        classObj = document.getElementById("inputSobrenome")
        classObj.classList.remove("inputError")
        classObj.classList.add("inputSobrenome")
    };

    if (telFixo == "") {
        classObj = document.getElementById("inputTelefoneFixo")
        classObj.classList.remove("inputTelefoneFixo")
        classObj.classList.add("inputError")
        alert("Insira seu telefone fixo")

    } else {
        classObj = document.getElementById("inputTelefoneFixo")
        classObj.classList.add("inputTelefoneFixo")
        classObj.classList.remove("inputError")
    };

    if (telCel == "") {
        classObj = document.getElementById("inputTelefoneCel")
        classObj.classList.remove("inputTelefoneCel")
        classObj.classList.add("inputError")
        alert("Insira seu celular")
    } else {
        classObj = document.getElementById("inputTelefoneCel")
        classObj.classList.add("inputTelefoneCel")
        classObj.classList.remove("inputError")
    };

    if (telCel[0] != "(" && telCel[2] != ")" && telCel[9] != "-") {
        classObj = document.getElementById("inputTelefoneCel")
        classObj.classList.remove("inputTelefoneCel")
        classObj.classList.add("inputError")
        alert("Insira os caracteres no número")
    } else {
        classObj = document.getElementById("inputTelefoneCel")
        classObj.classList.add("inputTelefoneCel")
        classObj.classList.remove("inputError")
    };

    if (telCel.length != 14) {
        classObj = document.getElementById("inputTelefoneCel")
        classObj.classList.remove("inputTelefoneCel")
        classObj.classList.add("inputError")
        alert("Celular inserido incorretamente")
    } else {
        classObj = document.getElementById("inputTelefoneCel")
        classObj.classList.add("inputTelefoneCel")
        classObj.classList.remove("inputError")
    };

    if (email == "") {
        classObj = document.getElementById("inputEmail")
        classObj.classList.remove("inputEmail")
        classObj.classList.add("inputError")
        alert("Insira seu E-mail!")
    } else {
        classObj = document.getElementById("inputEmail")
        classObj.classList.add("inputEmail")
        classObj.classList.remove("inputError")
    };

    if (senha == "") {
        classObj = document.getElementById("inputSenha")
        classObj.classList.remove("inputSenha")
        classObj.classList.add("inputError")
        alert("Crie uma senha!")
    } else {
        classObj = document.getElementById("inputSenha")
        classObj.classList.add("inputSenha")
        classObj.classList.remove("inputError")
    };

    if (senha.length < 8) {
        classObj = document.getElementById("inputSenha")
        classObj.classList.remove("inputSenha")
        classObj.classList.add("inputError")
        alert("Sua senha deve ter no mínimo 8 carecteres")
    } else {
        classObj = document.getElementById("inputSenha")
        classObj.classList.add("inputSenha")
        classObj.classList.remove("inputError")
    };

    if (document.getElementsByClassName("inputError").length > 0) {
      
    } else{
        window.location = "Dashboard.html"
    }
  }

    function cadastrarFuncionario() {
      validacaoCadastro() 

       //Recupere o valor da nova input pelo nome do id
    // Agora vá para o método fetch logo abaixo
    nome = inputNome.value
    sobrenome = inputSobrenome.value;
    telFixo = inputTelefoneCel.value;
    telCel = inputTelefoneCel.value;
    empresa = inputEmpresa.value;
    email = inputEmail.value;
    senha = inputSenha.value;


    // Enviando o valor da nova input
    fetch("/usuarios/cadastrarFuncionario", {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            // crie um atributo que recebe o valor recuperado aqui
            // Agora vá para o arquivo routes/usuario.js
            nomeServer: nome,
            sobrenomeServer: sobrenome,
            telFixoServer: telFixo,
            telCelServer: telCel,
            emailServer: email,
            senhaServer: senha,
        })
    }).then(function (resposta) {

        console.log("resposta: ", resposta);

        if (resposta.ok) {
            
            console.log(resposta);

            setTimeout(() => {
                window.location = "Dashboard.html";
            }, "2000")

            // limparFormulario();
            // finalizarAguardar();
        } else {
            throw ("Houve um erro ao tentar realizar o cadastro!");
        }
    }).catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        // finalizarAguardar();
    });

    return false;
    
    }

</script>